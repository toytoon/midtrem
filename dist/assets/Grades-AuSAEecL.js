import{j as e}from"./query-DZDXimB5.js";import{r,u as T}from"./react-ZLBw_slV.js";import{u as C,l as I,B as k,C as d}from"./index-nyx0viYp.js";import{L as G,T as L,a as B,b as u,c as n,d as E,e as c}from"./table-BPlFWr6V.js";import{s as _}from"./client-CmkErKnx.js";import"./ui-Cv-0l-fj.js";import"./supabase-D8bFuZE2.js";const H=()=>{const[g,h]=r.useState(""),[f,b]=r.useState(""),[a,j]=r.useState([]),[p,N]=r.useState(!0),l=T(),{toast:i}=C(),x=r.useCallback(async s=>{try{const{data:t,error:o}=await _.from("grades").select(`
          grade,
          courses (
            course_name
          )
        `).eq("student_id",s);if(o)throw o;const S=t.map(m=>({courseName:m.courses.course_name,grade:m.grade}));j(S)}catch{i({title:"خطأ",description:"حدث خطأ أثناء تحميل الدرجات",variant:"destructive"})}finally{N(!1)}},[i]);r.useEffect(()=>{const s=sessionStorage.getItem("studentId"),t=sessionStorage.getItem("studentName"),o=sessionStorage.getItem("studentCode");if(!s){l("/");return}h(t||""),b(o||""),x(s)},[l,x]);const v=()=>{sessionStorage.removeItem("studentId"),sessionStorage.removeItem("studentName"),l("/student/login")},w=a.reduce((s,t)=>s+t.grade,0),y=a.length*30;return e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-8",style:{background:"var(--gradient-primary)"},children:e.jsxs("div",{className:"flex flex-col items-center gap-8 w-full max-w-4xl",children:[e.jsxs("div",{className:"flex flex-col items-center gap-4 w-full",children:[e.jsx("img",{src:I,alt:"institute Logo",className:"w-32 h-32 object-contain rounded-full shadow-[var(--shadow-glow)]"}),e.jsx("h1",{className:"text-4xl font-bold text-foreground text-center",children:"درجات الطالب - الطالبة"}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-xl text-foreground font-semibold",children:g}),e.jsxs("p",{className:"text-lg text-muted-foreground",children:["  الكود الأكاديمي : ",f]})]}),e.jsxs(k,{variant:"outline",onClick:v,className:"gap-2 border-border bg-secondary/50 hover:bg-secondary text-foreground",children:[e.jsx(G,{className:"w-4 h-4"}),"الرجوع"]})]}),p?e.jsx(d,{className:"w-full bg-card/95 backdrop-blur-sm border-border shadow-[var(--shadow-glow)] p-8",children:e.jsx("p",{className:"text-center text-foreground",children:"جاري التحميل..."})}):a.length===0?e.jsx(d,{className:"w-full bg-card/95 backdrop-blur-sm border-border shadow-[var(--shadow-glow)] p-8",children:e.jsx("p",{className:"text-center text-foreground",children:"لا توجد درجات مسجلة"})}):e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"w-full bg-card/95 backdrop-blur-sm border-border shadow-[var(--shadow-glow)]",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(L,{children:[e.jsx(B,{children:e.jsxs(u,{className:"border-border hover:bg-transparent",children:[e.jsx(n,{className:"text-right text-foreground font-semibold",children:"#"}),e.jsx(n,{className:"text-right text-foreground font-semibold",children:"اسم المادة"}),e.jsx(n,{className:"text-right text-foreground font-semibold",children:"الدرجة (من 30)"})]})}),e.jsx(E,{children:a.map((s,t)=>e.jsxs(u,{className:`border-border ${s.grade<15?"bg-destructive/10 hover:bg-destructive/20":"hover:bg-secondary/50"}`,children:[e.jsx(c,{className:"text-foreground",children:t+1}),e.jsx(c,{className:"text-foreground font-medium",children:s.courseName}),e.jsx(c,{className:`text-lg font-bold ${s.grade<15?"text-destructive":"text-primary"}`,children:s.grade})]},t))})]})})}),e.jsx(d,{className:"w-full bg-card/95 backdrop-blur-sm border-border shadow-[var(--shadow-glow)] p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"المجموع الكلي"}),e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[w," / ",y]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"عدد المواد"}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:a.length})]})]})})]}),e.jsx("div",{className:"text-center text-sm text-muted-foreground mt-4",children:e.jsx("p",{children:"الدرجات التي تقل عن 15 يتم تمييزها باللون الأحمر"})})]})})},A=()=>e.jsx(H,{});export{A as default};
