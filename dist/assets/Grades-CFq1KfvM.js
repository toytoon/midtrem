import{j as e}from"./query-K9nIb-JY.js";import{r,u as k}from"./react-C0SUYmK-.js";import{B as C,C as l}from"./button-CJ1g5yGr.js";import{L as I,S as a,T as G,a as L,b as g,c as n,d as B,e as i}from"./skeleton-CbSoJ9EV.js";import{supabase as E}from"./client-B9lTMVOu.js";import{u as _}from"./index-BUpAmCwu.js";import"./supabase-BlUD6oWY.js";const H=()=>{const[h,b]=r.useState(""),[f,j]=r.useState(""),[o,p]=r.useState([]),[N,w]=r.useState(!0),c=k(),{toast:m}=_(),x=r.useCallback(async s=>{try{const{data:t,error:d}=await E.from("grades").select(`
          grade,
          courses (
            course_name
          )
        `).eq("student_id",s);if(d)throw d;const T=t.map(u=>({courseName:u.courses.course_name,grade:u.grade}));p(T)}catch{m({title:"خطأ",description:"حدث خطأ أثناء تحميل الدرجات",variant:"destructive"})}finally{w(!1)}},[m]);r.useEffect(()=>{const s=sessionStorage.getItem("studentId"),t=sessionStorage.getItem("studentName"),d=sessionStorage.getItem("studentCode");if(!s){c("/");return}b(t||""),j(d||""),x(s)},[c,x]);const v=()=>{sessionStorage.removeItem("studentId"),sessionStorage.removeItem("studentName"),c("/student/login")},y=o.reduce((s,t)=>s+t.grade,0),S=o.length*30;return e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-8",style:{background:"var(--gradient-primary)"},children:e.jsxs("div",{className:"flex flex-col items-center gap-8 w-full max-w-4xl",children:[e.jsxs("div",{className:"flex flex-col items-center gap-4 w-full",children:[e.jsx("img",{src:"/logo.png",alt:"institute Logo",width:128,height:128,className:"w-32 h-32 object-contain rounded-full shadow-[var(--shadow-glow)]"}),e.jsx("h1",{className:"text-4xl font-bold text-foreground text-center",children:"درجات الطالب - الطالبة"}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-xl text-foreground font-semibold",children:h}),e.jsxs("p",{className:"text-lg text-muted-foreground",children:["  الكود الأكاديمي : ",f]})]}),e.jsxs(C,{variant:"outline",onClick:v,className:"gap-2 border-border bg-secondary/50 hover:bg-secondary text-foreground",children:[e.jsx(I,{className:"w-4 h-4"}),"الرجوع"]})]}),N?e.jsx(l,{className:"w-full bg-card/95 backdrop-blur-sm border-border shadow-[var(--shadow-glow)]",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between border-b pb-4",children:[e.jsx(a,{className:"h-6 w-12"}),e.jsx(a,{className:"h-6 w-32"}),e.jsx(a,{className:"h-6 w-24"})]}),[1,2,3,4,5].map(s=>e.jsxs("div",{className:"flex justify-between py-4 border-b last:border-0",children:[e.jsx(a,{className:"h-6 w-8"}),e.jsx(a,{className:"h-6 w-48"}),e.jsx(a,{className:"h-6 w-16"})]},s))]})}):o.length===0?e.jsx(l,{className:"w-full bg-card/95 backdrop-blur-sm border-border shadow-[var(--shadow-glow)] p-8",children:e.jsx("p",{className:"text-center text-foreground",children:"لا توجد درجات مسجلة"})}):e.jsxs(e.Fragment,{children:[e.jsx(l,{className:"w-full bg-card/95 backdrop-blur-sm border-border shadow-[var(--shadow-glow)]",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(G,{children:[e.jsx(L,{children:e.jsxs(g,{className:"border-border hover:bg-transparent",children:[e.jsx(n,{className:"text-right text-foreground font-semibold",children:"#"}),e.jsx(n,{className:"text-right text-foreground font-semibold",children:"اسم المادة"}),e.jsx(n,{className:"text-right text-foreground font-semibold",children:"الدرجة (من 30)"})]})}),e.jsx(B,{children:o.map((s,t)=>e.jsxs(g,{className:`border-border ${s.grade<15?"bg-destructive/10 hover:bg-destructive/20":"hover:bg-secondary/50"}`,children:[e.jsx(i,{className:"text-foreground",children:t+1}),e.jsx(i,{className:"text-foreground font-medium",children:s.courseName}),e.jsx(i,{className:`text-lg font-bold ${s.grade<15?"text-destructive":"text-primary"}`,children:s.grade})]},t))})]})})}),e.jsx(l,{className:"w-full bg-card/95 backdrop-blur-sm border-border shadow-[var(--shadow-glow)] p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"المجموع الكلي"}),e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[y," / ",S]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"عدد المواد"}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:o.length})]})]})})]}),e.jsx("div",{className:"text-center text-sm text-muted-foreground mt-4",children:e.jsx("p",{children:"الدرجات التي تقل عن 15 يتم تمييزها باللون الأحمر"})})]})})},A=()=>e.jsx(H,{});export{A as default};
