import{supabase as n}from"./client-B9lTMVOu.js";import{d as p,a as w,g as A,s as v,b as g,c as h,v as y}from"./auth-utils-B0pbsvyB.js";import"./supabase-BlUD6oWY.js";import"./react-C0SUYmK-.js";const l=async(e,o)=>{try{const{data:r,error:a}=await n.from("admins").select("id, admin_code, admin_name, password_hash").eq("admin_code",e).single();if(a||!r)return console.log("Admin not found:",e),{success:!1,error:"Admin code or password is incorrect"};console.log("Admin found:",e);try{const{data:s,error:i}=await n.rpc("verify_password",{password:o,hash:r.password_hash});return i?(console.error("RPC verification error:",i),{success:!1,error:"Admin code or password is incorrect"}):s===!0?(console.log("Password verified successfully via RPC"),{success:!0,adminId:r.id,adminName:r.admin_name}):(console.log("Password verification failed - incorrect password"),{success:!1,error:"Admin code or password is incorrect"})}catch(s){return console.error("RPC call failed:",s),{success:!1,error:"Authentication service error"}}}catch(r){return console.error("Password verification error:",r),{success:!1,error:"An error occurred during authentication"}}},m=async(e,o,r,a)=>{};export{p as clearAdminSession,w as generateSessionToken,A as getAdminSession,m as logAdminAction,v as sanitizeInput,g as setAdminSession,h as validateGrade,y as validateStudentCode,l as verifyAdminPassword};
